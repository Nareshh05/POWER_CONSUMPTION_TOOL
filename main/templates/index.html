<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width" />
  <meta name="description" content="Tamilnadu Electricity Prediction" />
  <link rel="shortcut icon" type="image/x-icon" href="./assets/images/favicon/favicon.ico" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" />
  <link rel="stylesheet" href="https://unpkg.com/simplebar@latest/dist/simplebar.css" />

  <link rel="stylesheet" href="/static/css/theme.css" />
  <link rel="stylesheet" href="/static/css/vibrant.css" />

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-M8S4MT3EYG"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "G-M8S4MT3EYG");
  </script>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/apexcharts/dist/apexcharts.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

  <title>Power Consumption Monitor</title>
  <link rel="stylesheet" href="/static/css/ux.css" />
</head>

<body>
  <!-- Full Screen Loader -->
  <div id="page-loader">
    <div class="loader-content">
      <h2 class="text-3xl font-bold logo-gradient tracking-widest">POWER<br>CONSUMPTION</h2>
      <p class="text-gray-400 mt-2 text-sm">LOADING SMART MONITOR...</p>
    </div>
  </div>

  <div id="alert-container" class="fixed top-4 right-4 z-50 flex flex-col gap-2 pointer-events-none"
    style="width: 350px;"></div>
  <main>
    <div id="app-layout" class="overflow-x-hidden flex">
      <nav class="navbar-vertical navbar">
        <div id="myScrollableElement" class="h-screen" data-simplebar>
          <!-- brand logo -->
          <a class="navbar-brand flex items-center justify-center py-4" href="/dashbord">
            <h2 class="text-2xl font-bold logo-gradient tracking-wider text-center">POWER<br>CONSUMPTION</h2>
          </a>

          <ul class="navbar-nav flex-col" id="sideNavbar">
            <li class="nav-item">
              <a class="nav-link active" href="/dashbord">
                <i data-feather="home" class="w-4 h-4 mr-2"></i>
                Dashboard
              </a>
            </li>
            <li class="nav-item">
              <div class="navbar-heading">Pages</div>
            </li>
            <li class="nav-item">
              <a class="nav-link collapsed" href="/model">
                <i data-feather="layers" class="w-4 h-4 mr-2"></i>
                Electricity Model
              </a>
              <a class="nav-link collapsed" href="/tmodel">
                <i data-feather="layers" class="w-4 h-4 mr-2"></i>
                Energy Profiling
              </a>
            </li>
            <!-- nav item -->
            <!-- <li class="nav-item">
              <a class="nav-link" href="./layout.html">
                <i data-feather="sidebar" class="w-4 h-4 mr-2"></i>
                Feedback
              </a>
            </li> -->
            <!-- nav heading -->

            <li class="nav-item">
              <div class="navbar-heading">Others</div>
            </li>
            <!-- nav item -->
            <li class="nav-item">
              <a class="nav-link collapsed" href="/feedback">
                <i data-feather="message-square" class="w-4 h-4 mr-2"></i>
                Feedback
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link collapsed" href="/settings">
                <i data-feather="settings" class="w-4 h-4 mr-2"></i>
                Settings
              </a>
            </li>
            <!-- Authentication Section (Visible) -->
            <li class="nav-item mt-4">
              <div class="navbar-heading">Authentication</div>
            </li>
            <li class="nav-item">
              <a class="nav-link text-neon-blue" href="/sign-in">
                <i data-feather="log-in" class="w-4 h-4 mr-2"></i>
                Login
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link text-red-400" href="/logout">
                <i data-feather="log-out" class="w-4 h-4 mr-2"></i>
                Logout
              </a>
            </li>

          </ul>
        </div>
      </nav>
      <!--end of navbar-->

      <!-- app layout content -->
      <div id="app-layout-content"
        class="min-h-screen w-full min-w-[100vw] md:min-w-0 ml-[15.625rem] [transition:margin_0.25s_ease-out]">
        <!-- start navbar -->









        <div class="header">
          <nav class="bg-white px-6 py-[10px] flex items-center justify-between shadow-sm">


            <a id="nav-toggle" href="#" class="text-gray-800">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
              </svg>
            </a>
            <div class="ml-3 hidden md:hidden lg:block">
              <!-- form -->
              <form class="flex items-center">
                <input type="search"
                  class="border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none"
                  placeholder="Search" />
              </form>
            </div>
            <!-- navbar nav -->
            <ul class="flex ml-auto items-center">
              <li class="dropdown stopevent mr-2">
                <a class="text-gray-600" href="#" role="button" id="dropdownNotification" data-bs-toggle="dropdown"
                  aria-haspopup="true" aria-expanded="false">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0M3.124 7.5A8.969 8.969 0 015.292 3m13.416 0a8.969 8.969 0 012.168 4.5" />
                  </svg>
                </a>
                <div class="dropdown-menu dropdown-menu-lg lg:left-auto lg:right-0"
                  aria-labelledby="dropdownNotification">
                  <div>
                    <div class="border-b px-3 pt-2 pb-3 flex justify-between items-center">
                      <span class="text-lg text-gray-800 font-semibold">Notifications</span>
                      <a href="#">
                        <span>
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-4 h-4">
                            <path stroke-linecap="round" stroke-linejoin="round"
                              d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                          </svg>
                        </span>
                      </a>
                    </div>
                    <!-- list group -->
                    <ul class="h-56" data-simplebar="">
                      <!-- list group item -->
                      <li class="bg-gray-100 px-3 py-2 border-b">
                        <a href="#">
                          <h5 class="mb-1">Rishi Chopra</h5>
                          <p class="mb-0">
                            Mauris blandit erat id nunc blandit, ac eleifend
                            dolor pretium.
                          </p>
                        </a>
                      </li>
                      <!-- list group item -->
                      <li class="px-3 py-2 border-b">
                        <a href="#">
                          <h5 class="mb-1">Neha Kannned</h5>
                          <p class="mb-0">
                            Proin at elit vel est condimentum elementum id in
                            ante. Maecenas et sapien metus.
                          </p>
                        </a>
                      </li>
                      <!-- list group item -->
                      <li class="px-3 py-2 border-b">
                        <a href="#">
                          <h5 class="mb-1">Nirmala Chauhan</h5>
                          <p class="mb-0">
                            Morbi maximus urna lobortis elit sollicitudin
                            sollicitudieget elit vel pretium.
                          </p>
                        </a>
                      </li>
                      <!-- list group item -->
                      <li class="px-3 py-2 border-b">
                        <a href="#">
                          <h5 class="mb-1">Sina Ray</h5>
                          <p class="mb-0">
                            Sed aliquam augue sit amet mauris volutpat
                            hendrerit sed nunc eu diam.
                          </p>
                        </a>
                      </li>
                    </ul>
                    <div class="border-top px-3 py-2 text-center">
                      <a href="#" class="text-gray-800 font-semibold">View all Notifications</a>
                    </div>
                  </div>
                </div>
              </li>
              <!-- list -->
              <!-- User Profile Dropdown -->
              <li class="relative cursor-pointer z-50 ml-4 hidden md:block" onclick="toggleProfileModal(event)">
                <div class="flex items-center gap-3">
                  <img src="/static/images/avatar-1.jpg" alt="User"
                    class="w-10 h-10 rounded-full border-2 border-indigo-500 hover:border-indigo-600 transition shadow-sm">
                  <div class="text-right">
                    <h6 class="text-sm font-bold text-gray-800 m-0 leading-tight">Naresh Kumar</h6>
                    <p class="text-xs text-gray-500 m-0">Administrator</p>
                  </div>
                </div>
                <!-- Profile Modal -->
                <div id="profile-modal">
                  <div class="flex flex-col items-center">
                    <div
                      class="w-16 h-16 rounded-full bg-indigo-600 flex items-center justify-center text-2xl font-bold text-white mb-3 shadow-lg">
                      NK</div>
                    <h3 class="text-white font-bold text-lg">Naresh Kumar</h3>
                    <p class="text-gray-400 text-sm mb-4">naresh@example.com</p>
                    <div class="w-full border-t border-gray-700 pt-3">
                      <div class="flex justify-between items-center text-sm text-gray-300 mb-2">
                        <span>Role:</span>
                        <span class="text-neon-blue font-semibold">Administrator</span>
                      </div>
                      <div class="flex justify-between items-center text-sm text-gray-300">
                        <span>Status:</span>
                        <span class="text-green-400 font-semibold">Active</span>
                      </div>
                    </div>
                    <a href="/logout" class="mt-4 text-xs text-red-400 hover:text-red-300 transition">Sign Out</a>
                  </div>
                </div>
              </li>
            </ul>
          </nav>
        </div>
        <!-- end of navbar -->



















        <div class="bg-indigo-600 px-8 pt-10 lg:pt-14 pb-16 flex justify-between items-center mb-3">


          <h1 class="text-xl text-white">
            Smart Energy Monitor
          </h1>
          <a href="#"
            class="btn bg-white text-gray-800 border-gray-600 hover:bg-gray-100 hover:text-gray-800 hover:border-gray-200 active:bg-gray-100 active:text-gray-800 active:border-gray-200 focus:outline-none focus:ring-4 focus:ring-indigo-300">
            Create New Blog
          </a>
        </div>
        <div class="p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          <!-- card -->
          <div class="card shadow">
            <!-- card body -->
            <div class="card-body">
              <!-- content -->
              <div class="flex justify-between items-center">
                <h4>{{month}}'s Expected Peak</h4>
                <div
                  class="bg-indigo-600 bg-opacity-10 rounded-md w-10 h-10 flex items-center justify-center text-center text-indigo-600">
                  <i data-feather="briefcase"><img src="/static/images/peak.png" class="w-10 h-10"></i>
                </div>
              </div>
              <div class="mt-4 flex flex-col gap-0 text-base">
                <h2 class="text-xl font-bold">{{ cur_peak }}</h2>
                <!-- <div>
                  <span>2</span>
                  <span class="text-gray-500">Completed</span>
                </div> -->
              </div>
            </div>
          </div>
          <!-- card -->
          <div class="card shadow">
            <!-- card boduy -->
            <div class="card-body">
              <!-- content -->
              <div class="flex justify-between items-center">
                <h4>{{month}}'s Forecast</h4>
                <div
                  class="bg-indigo-600 bg-opacity-10 rounded-md w-10 h-10 flex items-center justify-center text-center text-indigo-600">
                  <i data-feather="briefcase"><img src="/static/images/forecast.png" class="w-10 h-10"></i>
                </div>
              </div>
              <div class="mt-4 flex flex-col gap-0 text-base">
                <h2 class="text-xl font-bold">{{cur_forec}}</h2>
                <div>
                  <!-- <span>28</span>
                  <span class="text-gray-500">Completed</span> -->
                </div>
              </div>
            </div>
          </div>
          <!-- card -->
          <div class="card shadow">
            <!-- card body -->
            <div class="card-body">
              <!-- content -->
              <div class="flex justify-between items-center">
                <h4>Average Temperature</h4>
                <div
                  class="bg-indigo-600 bg-opacity-10 rounded-md w-10 h-10 flex items-center justify-center text-center text-indigo-600">
                  <i data-feather="briefcase"><img src="/static/images/temp.png" class="w-10 h-10"></i>
                </div>
              </div>
              <div class="mt-4 flex flex-col gap-0 text-base">
                <h2 class="text-xl font-bold">{{ avg_temp }}&deg; C</h2>
                <!-- <div>
                  <span>1</span>
                  <span class="text-gray-500">Completed</span>
                </div> -->
              </div>
            </div>
          </div>
          <!-- card -->
          <div class="card shadow">
            <!-- card body -->
            <div class="card-body">
              <!-- content -->
              <div class="flex justify-between items-center">
                <h4>Today's Date</h4>
                <div
                  class="bg-indigo-600 bg-opacity-10 rounded-md w-10 h-10 flex items-center justify-center text-center text-indigo-600">
                  <i data-feather="briefcase"><img src="/static/images/date.png" class="w-10 h-10"></i>
                </div>
              </div>
              <div class="mt-4 flex flex-col gap-0 text-base">
                <h2 class="text-xl font-bold">{{date}}</h2>
                <!-- <div>
                  <span class="text-green-600">5%</span>
                  <span class="text-gray-500">Completed</span>
                </div> -->
              </div>
            </div>

          </div>

          <!-- Real-Time Analytics Section -->
          <!-- Real-Time Analytics Section -->
          <!-- Simplified Layout: Vertical stack on mobile, 2:1 split on large screens -->
          <!-- New: Dataset Upload & Controls -->
          <div class="px-6 mb-4 flex justify-end">
            <button
              class="btn btn-primary bg-indigo-600 text-white px-4 py-2 rounded shadow hover:bg-indigo-700 transition"
              onclick="document.getElementById('dataset-upload').click()">
              <i data-feather="upload" class="w-4 h-4 mr-2 inline"></i> Upload Dataset
            </button>
            <input type="file" id="dataset-upload" class="hidden" accept=".csv" onchange="uploadDataset(this)">
          </div>

          <!-- Real-Time Analytics Section -->
          <!-- Dynamic Layout: Stacks vertically for better readability on standard screens. Side-by-side only on very wide screens. -->
          <div class="px-6 mb-6 grid grid-cols-1 2xl:grid-cols-3 gap-6">

            <!-- Live Chart (Takes 2/3 width on ultra-wide, full width otherwise) -->
            <div class="card shadow 2xl:col-span-2 min-h-[500px]">
              <div class="card-body h-full flex flex-col">
                <div class="flex justify-between items-center mb-4">
                  <h4 class="text-neon-blue">Live Load Analytics (W)</h4>
                  <div id="live-indicator" class="flex items-center gap-2">
                    <span class="w-3 h-3 bg-neon-blue rounded-full animate-pulse"></span>
                    <span class="text-sm font-semibold whitespace-nowrap">LIVE FEED</span>
                  </div>
                </div>
                <!-- Added w-full to ensure canvas takes full width -->
                <div id="live-chart" class="flex-grow w-full relative"></div>
              </div>
            </div>

            <!-- Device Controls (Takes 1/3 width on ultra-wide, full width otherwise) -->
            <div class="card shadow min-h-[400px] 2xl:col-span-1 overflow-visible">
              <div class="card-body h-full flex flex-col justify-between">

                <div>
                  <h4 class="text-neon-yellow mb-6">Device Control</h4>
                  <div class="grid grid-cols-2 sm:grid-cols-4 2xl:grid-cols-2 gap-4 text-center">
                    <!-- AC Widget -->
                    <div
                      class="p-4 bg-glass rounded-xl border-glass flex flex-col items-center justify-center transition-all bg-opacity-20 cursor-pointer hover:scale-105 active:scale-95 group"
                      <div
                      class="p-4 bg-glass rounded-xl border-glass flex flex-col items-center justify-center transition-all bg-opacity-20 cursor-pointer hover:scale-105 active:scale-95 group"
                      id="ac-card" onclick="toggleDevice('ac')">
                      <i data-feather="wind" class="w-8 h-8 mb-2 group-hover:text-white transition-colors"
                        id="ac-icon"></i>
                      <span class="font-bold text-base">AC</span>
                      <span class="text-xs text-gray-400 uppercase mt-1" id="ac-status">OFF</span>
                      <span class="text-xs text-neon-blue font-mono" id="ac-power">0 W</span>
                    </div>
                    <!-- Fan Widget -->
                    <div
                      class="p-4 bg-glass rounded-xl border-glass flex flex-col items-center justify-center transition-all cursor-pointer hover:scale-105 active:scale-95 group"
                      id="fan-card" onclick="toggleDevice('fan')">
                      <i data-feather="aperture"
                        class="w-6 h-6 mb-2 animate-spin-slow group-hover:text-white transition-colors"
                        id="fan-icon"></i>
                      <span class="font-bold text-sm">Fan</span>
                      <span class="text-[10px] text-gray-400 uppercase" id="fan-status">ON</span>
                      <span class="text-[10px] text-neon-blue font-mono" id="fan-power">0 W</span>
                    </div>
                    <!-- Light Widget -->
                    <div
                      class="p-3 bg-glass rounded-xl border-glass flex flex-col items-center justify-center transition-all cursor-pointer hover:scale-105 active:scale-95 group"
                      id="light-card" onclick="toggleDevice('light')">
                      <i data-feather="sun" class="w-6 h-6 mb-2 group-hover:text-white transition-colors"
                        id="light-icon"></i>
                      <span class="font-bold text-sm">Light</span>
                      <span class="text-[10px] text-gray-400 uppercase" id="light-status">ON</span>
                      <span class="text-[10px] text-neon-blue font-mono" id="light-power">0 W</span>
                    </div>
                    <!-- TV Widget -->
                    <div
                      class="p-3 bg-glass rounded-xl border-glass flex flex-col items-center justify-center transition-all cursor-pointer hover:scale-105 active:scale-95 group"
                      id="tv-card" onclick="toggleDevice('tv')">
                      <i data-feather="tv" class="w-6 h-6 mb-2 group-hover:text-white transition-colors"
                        id="tv-icon"></i>
                      <span class="font-bold text-sm">TV</span>
                      <span class="text-[10px] text-gray-400 uppercase" id="tv-status">OFF</span>
                      <span class="text-[10px] text-neon-blue font-mono" id="tv-power">0 W</span>
                    </div>
                    <!-- Fridge Widget -->
                    <div
                      class="p-3 bg-glass rounded-xl border-glass flex flex-col items-center justify-center transition-all cursor-pointer hover:scale-105 active:scale-95 group"
                      id="fridge-card" onclick="toggleDevice('fridge')">
                      <i data-feather="box" class="w-6 h-6 mb-2 group-hover:text-white transition-colors"
                        id="fridge-icon"></i>
                      <span class="font-bold text-sm">Fridge</span>
                      <span class="text-[10px] text-gray-400 uppercase" id="fridge-status">ON</span>
                      <span class="text-[10px] text-neon-blue font-mono" id="fridge-power">0 W</span>
                    </div>
                  </div>
                </div>

                <div class="mt-6 space-y-4">
                  <div class="div-health p-4 bg-glass rounded-2xl border-glass">
                    <span class="text-gray-400 block text-xs uppercase tracking-wider">System Health</span>
                    <h3 id="live-health" class="text-2xl font-bold mt-1 text-neon-blue">Scanning...</h3>
                  </div>
                  <div class="div-load p-4 bg-glass rounded-2xl border-glass">
                    <span class="text-gray-400 block text-xs uppercase tracking-wider">Instant Load</span>
                    <h3 id="live-load" class="text-2xl font-bold mt-1 text-white">0.00 W</h3>
                  </div>
                  <div class="div-projected p-4 bg-glass rounded-2xl border-glass">
                    <span class="text-gray-400 block text-xs uppercase tracking-wider">Projected Daily</span>
                    <h3 id="live-projected" class="text-2xl font-bold mt-1 text-neon-pink">0.00 kWh</h3>
                  </div>
                </div>

              </div>
            </div>

          </div>

        </div>
      </div>
    </div>
    </div>
    <footer class="bg-gray-700 text-gray-100 py-6">
      <div class="container mx-auto px-4">
        <div class="flex flex-col items-center">
          <!-- Title -->
          <div class="mb-6">
            <h3 class="text-2xl font-bold text-gray-100">Interested in our DataSets?</h3>
          </div>

          <!-- List of datasets -->
          <div class="flex flex-wrap justify-center gap-6">
            <!-- Dataset 1 -->
            <div class="flex flex-col items-center bg-gray-800 p-4 rounded-lg shadow-md space-y-4 mb-8 w-64">
              <h4 class="text-lg font-semibold text-white">
                Peak Electricity Consumption
              </h4>
              <a href="/static/Datasets/tamilnadu_peak.csv" download>
                <button
                  class="transition duration-300 bg-blue-500 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg flex items-center space-x-2 mt-4">
                  <span>Download</span>
                  <i class='bx bx-down-arrow-alt text-xl'></i>
                </button>
              </a>
            </div>

            <!-- Dataset 2 -->
            <div class="flex flex-col items-center bg-gray-800 p-4 rounded-lg shadow-md space-y-4 mb-8 w-64">
              <h4 class="text-lg font-semibold text-white">
                Electricity Consumption Dataset
              </h4>
              <a href="/static/Datasets/tamilnadu.csv" download>
                <button
                  class="transition duration-300 bg-blue-500 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg flex items-center space-x-2 mt-4">
                  <span>Download</span>
                  <i class='bx bx-down-arrow-alt text-xl'></i>
                </button>
              </a>
            </div>

            <!-- Dataset 3 -->
            <div class="flex flex-col items-center bg-gray-800 p-4 rounded-lg shadow-md space-y-4 mb-8 w-64">
              <h4 class="text-lg font-semibold text-white">
                Renewable Energy Dataset
              </h4>
              <a href="/static/Datasets/rene_energy.json" download>
                <button
                  class="transition duration-300 bg-blue-500 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg flex items-center space-x-2 mt-4">
                  <span>Download</span>
                  <i class='bx bx-down-arrow-alt text-xl'></i>
                </button>
              </a>
            </div>

            <!-- Dataset 4 -->
            <div class="flex flex-col items-center bg-gray-800 p-4 rounded-lg shadow-md space-y-4 mb-8 w-64">
              <h4 class="text-lg font-semibold text-white">
                Power Generation Dataset
              </h4>
              <a href="/static/Datasets/power_Generation.json" download>
                <button
                  class="transition duration-300 bg-blue-500 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg flex items-center space-x-2 mt-4">
                  <span>Download</span>
                  <i class='bx bx-down-arrow-alt text-xl'></i>
                </button>
              </a>
            </div>
          </div>
        </div>
      </div>
      <!-- Dataset 2 -->

    </footer>



    </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

  <!-- Libs JS -->
  <script src="https://unpkg.com/feather-icons"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/simplebar@latest/dist/simplebar.min.js"></script>

  <script src="/static/js/theme.js"></script>
  <script>
    // Socket.io Real-Time Data Logic
    var socket = io();
    var liveDataPoints = [];
    var liveTimeLabels = [];

    var options = {
      series: [{
        name: 'Current Load (W)',
        data: liveDataPoints
      }],
      chart: {
        id: 'realtime',
        height: 350,
        type: 'line',
        animations: {
          enabled: true,
          easing: 'linear',
          dynamicAnimation: {
            speed: 1000
          }
        },
        toolbar: {
          show: false
        },
        zoom: {
          enabled: false
        }
      },
      dataLabels: {
        enabled: false
      },
      stroke: {
        curve: 'smooth',
        width: 4,
        colors: ['#00f2fe']
      },
      title: {
        text: '',
        align: 'left'
      },
      markers: {
        size: 0
      },
      xaxis: {
        categories: liveTimeLabels,
        range: 10,
        labels: {
          show: true,
          style: { colors: '#94a3b8' }
        }
      },
      yaxis: {
        labels: {
          style: { colors: '#94a3b8' }
        }
      },
      legend: {
        show: false
      },
      grid: {
        borderColor: 'rgba(255,255,255,0.05)'
      }
    };

    var chart = new ApexCharts(document.querySelector("#live-chart"), options);
    chart.render();

    socket.on('live_data', function (msg) {
      document.getElementById('live-load').innerText = msg.load + " W";
      document.getElementById('live-health').innerText = msg.health;
      if (msg.projected_daily) {
        document.getElementById('live-projected').innerText = msg.projected_daily + " kWh";
      }

      updateAllDevices(msg.devices, msg.device_loads);

      // Update Health Color
      if (msg.health === "Critical") {
        document.getElementById('live-health').style.color = "#f12711";
      } else {
        document.getElementById('live-health').style.color = "#00f2fe";
      }

      // Update Chart
      liveDataPoints.push(parseFloat(msg.load));
      liveTimeLabels.push(msg.timestamp);

      if (liveDataPoints.length > 20) {
        liveDataPoints.shift();
        liveTimeLabels.shift();
      }

      chart.updateSeries([{
        data: liveDataPoints
      }]);
    });

    socket.on('alert', function (msg) {
      var container = document.getElementById('alert-container');
      var alert = document.createElement('div');
      alert.className = 'card glass shadow-2xl border-neon-pink p-4 animate-bounce pointer-events-auto';
      alert.style.borderColor = "#f12711";
      alert.innerHTML = `
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-neon-pink rounded-full flex items-center justify-center text-white">
            <i data-feather="alert-triangle"></i>
          </div>
          <div>
            <h5 class="text-neon-pink font-bold m-0">SYSTEM ALERT</h5>
            <p class="text-sm text-white m-0">${msg.message}</p>
          </div>
        </div>
      `;
      container.appendChild(alert);
      feather.replace();

      setTimeout(function () {
        alert.classList.remove('animate-bounce');
        alert.style.opacity = '1';
        setTimeout(function () {
          alert.style.transition = 'opacity 1s ease';
          alert.style.opacity = '0';
          setTimeout(() => alert.remove(), 1000);
        }, 5000);
      }, 1000);
    });

    socket.on('email_alert', function (msg) {
      var container = document.getElementById('alert-container');
      var alert = document.createElement('div');
      alert.className = 'card glass shadow-2xl border-l-4 border-neon-blue p-4 animate-slideInLeft pointer-events-auto bg-gray-900';
      alert.innerHTML = `
            <div class="flex items-start gap-3">
                <div class="mt-1 text-neon-blue">
                    <i data-feather="mail"></i>
                </div>
                <div>
                    <h5 class="text-neon-blue font-bold m-0 text-sm">TARGETED ALERT SENT</h5>
                    <p class="text-xs text-gray-300 m-0">To: ${msg.email}</p>
                    <p class="text-xs text-white mt-1">${msg.message}</p>
                </div>
            </div>
        `;
      container.appendChild(alert);
      feather.replace();

      // Auto remove after 6 seconds
      setTimeout(() => {
        alert.style.opacity = '0';
        setTimeout(() => alert.remove(), 500);
      }, 6000);
    });

    // Device Interactivity
    function toggleDevice(deviceName) {
      socket.emit('toggle_device', { device: deviceName });
      // Optimistic UI update (will be confirmed by server)
      const status = document.getElementById(deviceName + '-status');
      status.innerText = "SWITCHING...";
    }

    // Helper to update all devices from state object
    function updateAllDevices(devices, loads) {
      updateDeviceState('ac', devices.ac, loads ? loads.ac : 0, 'bg-indigo-600');
      updateDeviceState('fan', devices.fan, loads ? loads.fan : 0, 'bg-blue-500');
      updateDeviceState('light', devices.light, loads ? loads.light : 0, 'bg-yellow-500');
      updateDeviceState('tv', devices.tv, loads ? loads.tv : 0, 'bg-purple-500');
      updateDeviceState('fridge', devices.fridge, loads ? loads.fridge : 0, 'bg-teal-500');
    }

    function updateDeviceState(id, isOn, load, colorClass) {
      const card = document.getElementById(id + '-card');
      const status = document.getElementById(id + '-status');
      const icon = document.getElementById(id + '-icon');
      const powerLabel = document.getElementById(id + '-power');

      if (powerLabel) {
        powerLabel.innerText = load + " W";
      }

      if (isOn) {
        card.classList.add(colorClass);
        card.style.borderColor = "var(--neon-blue)";
        card.classList.add("shadow-lg");
        status.innerText = "ON";
        status.style.color = "#fff";
        icon.style.color = "#fff";
      } else {
        card.classList.remove(colorClass);
        card.style.borderColor = "rgba(255,255,255,0.1)";
        card.classList.remove("shadow-lg");
        status.innerText = "OFF";
        status.style.color = "#6b7280";
        icon.style.color = "#6b7280";
      }
    }

    // Dataset Upload Function
    function uploadDataset(input) {
      if (input.files && input.files[0]) {
        const formData = new FormData();
        formData.append('file', input.files[0]);

        fetch('/upload_dataset', {
          method: 'POST',
          body: formData
        })
          .then(response => response.json())
          .then(data => {
            if (data.success) {
              alert('Dataset uploaded successfully! Reloading page...');
              location.reload();
            } else {
              alert('Error: ' + data.error);
            }
          })
          .catch(error => {
            console.error('Error:', error);
            alert('An error occurred during upload.');
          });
      }
    }
  </script>
  <script src="/static/js/ux.js"></script>
</body>

</html>